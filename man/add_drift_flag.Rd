% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/add_drift_flag.R
\name{add_drift_flag}
\alias{add_drift_flag}
\title{Flag sensor drift in optical measurements}
\usage{
add_drift_flag(df)
}
\arguments{
\item{df}{A data frame containing water quality measurements. Must include columns:
\itemize{
\item \code{parameter}: The measurement type (function checks if it's an optical parameter)
\item \code{mean}: The calculated mean value of measurements
\item \code{flag}: Existing quality flags (will be updated by this function)
\item \code{DT_round}: Timestamp for rolling window analysis
}}
}
\value{
A data frame with the same structure as the input, but with the \code{flag}
column updated to include "drift" for periods showing evidence of sensor drift.
}
\description{
Identifies and flags periods when optical sensors show evidence of progressive drift,
which often indicates biofouling issues. The function analyzes time series
patterns to detect when measurements show a steady linear trend over time that is
unlikely to represent natural environmental conditions.

The function only processes optical parameters prone to biofouling:
\itemize{
\item FDOM Fluorescence
\item Turbidity
\item Chl-a Fluorescence
}

For other parameters, the function returns the dataframe unchanged.
}
\details{
This function checks for drift in 4 rolling windows and assigns a drift flag if any of these
rolling windows has a linear relationship with an R-squared value >= 0.6 for at least 1 day. The four rolling windows are:
\enumerate{
\item 1-day window aligned to the right
\item 1-day window centered
\item 3-day window aligned to the right
\item 3-day window centered
}

These windows are calculated using the \code{slider} package to efficiently compute rolling statistics.
The windows are also broken up by site visits when a sensor is cleaned as we know that sensor biofouling is
typically reset/stopped from a cleaning visit
}
\examples{
# Examples are temporarily disabled
}
\seealso{
\code{\link[=add_flag]{add_flag()}}
}
